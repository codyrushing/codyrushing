---
title: Setting up a Raspberry Pi as a home web server from scratch
date: 14/01/14
tags: [tutorials, raspberry pi, networking, raspbian, linux, hardware, apache]
intro: My Raspberry Pi has mostly been collecting dust since I got it. Setting it up as a LAMP home web server definitely isn't anything groundbreaking, but it at least helped me start to get familiar with the thing.
---

<p>My Raspberry Pi has mostly been collecting dust since I got it. Setting it up as a LAMP home web server definitely isn't anything groundbreaking, but it at least helped me start to get familiar with the thing.<!--more--> Plus, if you're already paying for any sort of web hosting, running it as a web server will cause the Pi to pay for itself in a few months.</p>

<p>There are tons of tutorials out there on turning Pis into web servers, but nothing that went through the entire process from start to finish, and that were made for people like me who don't know a lot about Linux, networking, and servers in general. I had to cobble together resources from a dozen or so places, <a href="http://www.dingleberrypi.com/">Dingleberry Pi</a> being one of the best.</p>

<h2>Setting up the OS (Raspbian)</h2>

<p>There are many different Linux distros that'll run on the Pi, but Raspbian seems to be one of the most popular. It's a version of Debian that has been custom built for the Pi. Most people boot the Pi from the SD card, but <a href="http://www.dingleberrypi.com/2013/05/install-and-run-raspbian-from-a-usb-flash-drive/">Dingleberry Pi recommends booting from USB flash drive for performance reasons</a>. If you are already booting Raspbian from SD, that should be fine too. If you've just started with your Pi and need to install Debian, there are tons of tutorials for how to do that, but I would recommend the Dingleberry Pi link above.</p>

<p>When you first boot Raspbian, you'll see the raspi-config prompt, which allows you to change some of the system settings. I would recommend going to the overclock settings and enabling a modest overclock (800mhz). You can also do this whenever you like by runningÂ <code class="language-bash">sudo raspi-config</code>.</p>

<h2>Connecting to your Pi</h2>
<p>Up until this point, you've had to interface with your Pi by hooking it up to a display and probably using a USB keyboard.  You'll want to ditch that approach and just SSH into it.  Until you set up your router to allow external connections to your Pi, you'll need to be on the same network as your Pi in order to SSH into it.  Without wifi, which we'll set up later, you'll need to connect your Pi to your router via an ethernet cable.  Once you do that, on another machine on your network, you should be able to SSH into your pi.  The default user for the Pi is "pi", and its internal hostname on your network should be "raspberrypi" (you can change both of these in the raspi-config).  So, you should be able to connect via SSH by running <code class="language-bash">ssh pi@raspberrypi</code> on any machine in the network.</p>

<h2>Setting up wifi</h2>
<p>Yes, a Pi web server probably won't be moving around too much, so you could probably just rely on having a wired ethernet connection.  Still, I feel like the whole point of Raspberry Pi and mobile computing in general is to be mobile-ready.  So, wifi management is going to be a must.  Note that the Pi does not have built-in wifi, so you'll need a USB wifi dongle to make that happen.  I used <a href="https://www.adafruit.com/products/1012">this one from Adafruit</a>, but there are several Pi-compatible ones out there.  As far as software, I use a tool called wicd-curses, which gives you a nice little command line interface for managing network connections.  No need to manually edit your /etc/network/interfaces file.  <a href="http://www.raspyfi.com/wi-fi-on-raspberry-pi-a-simple-guide/">Here's a quick guide on how to install wicd-curses</a>.</p>

<h2>Router configuration</h2>
<p>Here's a little rundown of home networks, because I had no idea before this.  When a device connects to your home network, the router assigns it an IP address.  But it's just an internal IP address (probably looks something like 192.168.x.xxx, depending on your router) &ndash; only devices on the network can access you via that IP.  The router allows the devices connected to it to make requests out to the outside world.  Your router has an external IP and is accessible by the outside world, but it has a firewall which prevents external traffic from reaching the devices connected to the network, which is great for security.  But, if you want to host a web server from inside your home network, you'll have to configure the firewall to allow external traffic to hit the Pi.</p>

<p>To make that happen, you have to do a couple things.  First, you need to tell your router to always assign your Pi the same IP, because its IP can change if you reboot your router or simple disconnect and reconnect.  You could do this by setting up a static IP in wicd-curses.  Or, you could set up a DHCP lease on your router based on your Pi's MAC address, which is just a hardware identifier.  If you run <code class="language-bash">iwconfig</code> you can get your Pi's MAC address.  You can use that as well as the Pi's hostname to set up a lease in your router.  Having a reserved IP for the Pi is necessary for this next step, which is to forward web traffic to your Pi.  Your router should have some sort of port forwarding section.  This is basically where you punch a hole in the firewall to allow traffic to hit one of the devices on your network.  You'll want to forward port 80 (the http port) to the reserved IP you set up.  Note that if you want to SSH into your Pi from outside your network, you'll need to set up another port forward entry for SSH.  The default SSH port is 22, so you could just forward that to your Pi's IP address.  It's also a good idea from a security perspective to configure the Pi to use a more obscure port for SSH.</p>

<h2>Dynamic DNS</h2>
<p>Ok, so now if someone hits your router's external IP address, it will forward that traffic to your Pi &ndash; great.  The problem with that is that your ISP assigns your router its external IP, and that could change at any time.  That makes it impossible to point a domain to a fixed IP, since that IP could potentially change.  The solution to that is a dynamic DNS service.  This is basically a piece of software that runs on your Pi that periodically checks to see if your router's external IP has changed, and if so will notify your domain provider to update your domain records with the new IP.  There are free dynamic DNS services out there, like <a href="http://www.duckdns.org/">Duck DNS</a>, which only allows you to use a duckdns.org subdomain.  If, however, you have a domain hosted at <a href="https://www.namecheap.com/">Namecheap</a>, they offer free dynamic DNS, which is pretty sweet.  There is a Linux dynamic DNS client called ddclient, and this guy has a <a href="http://en.code-bude.net/2013/07/21/how-to-setup-ddclient-on-raspberry-pi-for-use-with-namecheap-dyndns/">great write-up on how to set it up for Namecheap</a>.</p>

<p>To prevent any downtime for your site, you'll want to run ddclient whenever the Pi boots up, so that it's always listening for IP changes.  To do that, you can use <code>update-rc.d</code>, which I guess is a Linux utility to add startup scripts &ndash; <a href="http://www.raspberrypi.org/phpBB3/viewtopic.php?f=27&t=29721">here's a link that explains it a little more</a>.</p>

<h2>Securing SSH with private key files</h2>
<p>If you're going to be opening your Pi up to external SSH traffic, you may consider securing your SSH with public/private key files as opposed to simple password authentication.  Basically you whitelist a list of machines that can access the Pi over SSH; any attempted SSH connections from other machines should be refused.  Think of it as the way github works.  <a href="http://steve.dynedge.co.uk/2012/05/30/logging-into-a-rasberry-pi-using-publicprivate-keys/">This guy explains how to set that up</a>.</p>

<h2>Installing Apache, PHP, and MySQL</h2>
<p>There are tons of tutorials for how to set up a LAMP stack on a Pi, <a href="http://www.dingleberrypi.com/2012/09/tutorial-install-apache-php-and-mysql-on-raspberry-pi/">here's one from Dingleberry Pi</a> that I used.  When it comes time to actually get your site online, you'll want to check out their <a href="http://www.dingleberrypi.com/2013/08/add-virtual-hosts-and-subdomains-to-your-raspberry-pi-apache2-server/">tutorial on virtual hosts</a>.</p>
